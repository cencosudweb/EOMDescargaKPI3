El programa se esta ejecutando...
Inicio Programa: 31/10/17 10:26:32

sFechaIni: 15-10-2017

sFechaFin: 17-10-2017

Query : SELECT PO.tc_purchase_orders_id   as N_Solicitud_Cliente ,POL.tc_po_line_id ,PO.created_dttm            as Fecha_Creacion_Solic ,O.tc_order_id              as N_Orden_Distribu ,O.created_dttm             as Fecha_Creacion_Orden ,MIN(POL.comm_dlvr_dttm)    as FechaCompromiso ,MIN(POL.COMM_SHIP_DTTM)    as FechaSalidaCD ,TO_CHAR(MIN(POL.comm_dlvr_dttm), 'DD-MM-YYYY HH24:MI:SS') as FechaEntregaCliente ,POS.description            as Est_Orden ,POS2.description           as Estado_de_Linea ,POL.sku                    as SKU ,POL.allocated_qty          as Cant_Desc_SKU ,IC.prod_type               as Depart ,PO.entry_code              as Local_Venta ,MAX(AO.A_DCNAME)           AS BodegaDesp ,NVL(MAX(ASND.ref_field_7), 'Sin Informacion')      AS Est_1  ,NVL(MAX(ASND.ref_field_9), 'Sin Informacion')      AS Est_Entrega ,MIN(ASND.ref_field_10)     AS Fecha_Entr_Cliente ,PO.customer_user_id        AS RutCliente ,PO.customer_firstname      AS NombreCliente ,PO.customer_lastname       AS ApellidoCliente ,POL.d_address_1            as Direccion_Cliente  ,POL.d_county               as Comuna ,POL.d_city                 as Ciudad ,POL.d_state_prov           as Region ,POLW.REF_FIELD_2           as Horario ,OT.order_type              as Tipo_Orden ,CASE   WHEN ao.a_allocation_type = 1 THEN 'VEV CD' WHEN ao.a_allocation_type = 0 AND MAX(AO.A_DCNAME) NOT IN ('012', '200')THEN 'VEV PD' ELSE  'CD DESPACHA' END    as Tipo_Venta ,pol.comm_dlvr_dttm         as fecha_compromiso_2 ,o.O_FACILITY_ALIAS_ID ,CASE  WHEN POL.d_state_prov in (13,50) THEN 'RM' ELSE 'REGIONES'  END AS RegionEntrega ,CASE  WHEN OT.order_type_id = 2 OR OT.order_type_id = 3 THEN 'POS'  ELSE OT.order_type END AS TIPO_DE_ORDEN ,CASE  WHEN  MAX(ASND.ref_field_7) in ('Entregado','Entrega ','Entrega parcial', 'Recogido', 'Recogido parcial')   AND (TO_NUMBER(TO_CHAR((MIN(POL.comm_dlvr_dttm)),'YYYYMMDD')) - TO_NUMBER(to_char(to_timestamp((MIN(ASND.ref_field_10)),'YYYY-MM-DD HH24:MI:SS,FF3'),'YYYYMMDD')))  < -0.001 then 'ATRASADO'  WHEN MAX(ASND.ref_field_7) in ('Entregado','Entrega ','Entrega parcial', 'Recogido', 'Recogido parcial')    AND (TO_NUMBER(TO_CHAR((MIN(POL.comm_dlvr_dttm)),'YYYYMMDD')) - TO_NUMBER(to_char(to_timestamp((MIN(ASND.ref_field_10)),'YYYY-MM-DD HH24:MI:SS,FF3'),'YYYYMMDD')))  <= 0 then 'EN FECHA'  WHEN MAX(ASND.ref_field_7) in ('Entregado','Entrega ','Entrega parcial', 'Recogido', 'Recogido parcial')   AND (TO_NUMBER(TO_CHAR((MIN(POL.comm_dlvr_dttm)),'YYYYMMDD')) - TO_NUMBER(to_char(to_timestamp((MIN(ASND.ref_field_10)),'YYYY-MM-DD HH24:MI:SS,FF3'),'YYYYMMDD')))  >0 then 'ADELANTADO'  else  NVL(MAX(ASND.ref_field_9), 'Sin Informacion') end as cumplimiento ,POL.D_POSTAL_CODE ,PO.EXT_PURCHASE_ORDERS_ID ,POL.TOTAL_MONETARY_VALUE ,POL.UNIT_MONETARY_VALUE ,PO.TC_PURCHASE_ORDERS_ID ,PO.PURCHASE_ORDERS_TYPE ,PO.PARENT_PURCHASE_ORDERS_ID ,nvl(POL.D_EMAIL, o.bill_to_email) as D_EMAIL ,po.on_hold ,po.payment_status ,POL.order_fulfillment_option FROM CA14.purchase_orders po INNER JOIN CA14.PURCHASE_ORDERS_LINE_ITEM POL ON pol.purchase_orders_id = po.purchase_orders_id AND POL.Purchase_Orders_Line_Status <> 940 INNER JOIN CA14.purchase_orders_status pos  ON pos.purchase_orders_status = po.purchase_orders_status INNER JOIN CA14.purchase_orders_status pos2   ON pos2.purchase_orders_status = pol.purchase_orders_line_status  INNER JOIN CA14.a_orderinventoryallocation ao ON ao.a_orderlineid = pol.purchase_orders_line_item_id AND AO.A_DCNAME NOT IN ('012', '200') AND ao.a_skuid =  pol.sku_id  INNER JOIN CA14.order_type ot  ON ot.order_type_id = po.order_category INNER JOIN CA14.item_cbo ic ON ic.item_id = POL.SKU_ID INNER JOIN CA14.order_line_item OLI  ON OLI.PURCHASE_ORDER_LINE_NUMBER = POL.TC_PO_LINE_ID AND OLI.mo_line_item_id = POL.purchase_orders_line_item_id AND OLI.ITEM_ID = POL.SKU_ID AND Oli.Is_Cancelled = 0   left JOIN CA14.orders o ON o.purchase_order_id =  po.purchase_orders_id  AND o.Order_ID = OLI.Order_ID AND o.IS_CANCELLED = 0 LEFT JOIN CA14.ASN_DETAIL ASND ON asnd.ORDER_LINE_ITEM_ID = OLI.LINE_ITEM_ID  AND asnd.order_id           = OLI.Order_Id AND asnd.tc_order_line_id   = OLI.Tc_Order_Line_Id AND ASND.ORDER_LINE_ITEM_ID = OLI.LINE_ITEM_ID  LEFT JOIN CA14.PO_LINE_WMPROCESSINFO POLW      ON POLW.PURCHASE_ORDERS_LINE_ITEM_ID = pol.PURCHASE_ORDERS_LINE_ITEM_ID  WHERE ot.order_type_id IN (2, 3, 6, 12, 14, 22, 42, 82) AND PO.is_purchase_orders_confirmed = '1' AND pol.comm_dlvr_dttm >= to_date('15-10-2017 00:00:01','DD-MM-YYYY HH24:MI:SS') AND pol.comm_dlvr_dttm <= to_date('17-10-2017 23:59:59','DD-MM-YYYY HH24:MI:SS')  AND O.tc_order_id is not null  AND ((o.o_facility_alias_id  NOT IN ('012', '200') AND POL.Purchase_Orders_Line_Status > 400)  OR (o.o_facility_alias_id  IN ('012', '200') AND POL.Purchase_Orders_Line_Status <= 400))  GROUP BY po.tc_purchase_orders_id, po.created_dttm, o.tc_order_id, o.created_dttm, pol.must_dlvr_dttm  ,pos.description, pol.sku, pol.allocated_qty, ic.prod_type, po.entry_code, pol.d_address_1 ,pol.d_county, pol.d_city, pol.d_state_prov, ot.order_type, POLW.REF_FIELD_2, po.customer_user_id ,po.customer_firstname, po.customer_lastname, pos2.description ,pol.tc_po_line_id, pol.comm_dlvr_dttm, o.O_FACILITY_ALIAS_ID ,ao.a_allocation_type,POL.D_POSTAL_CODE ,PO.EXT_PURCHASE_ORDERS_ID,POL.TOTAL_MONETARY_VALUE,POL.UNIT_MONETARY_VALUE,PO.TC_PURCHASE_ORDERS_ID,PO.PURCHASE_ORDERS_TYPE,PO.PARENT_PURCHASE_ORDERS_ID,POL.D_EMAIL,po.on_hold,po.payment_status,OT.order_type_id,o.bill_to_email,POL.order_fulfillment_option  UNION SELECT   PO.tc_purchase_orders_id   as N_Solicitud_Cliente ,POL.tc_po_line_id ,PO.created_dttm            as Fecha_Creacion_Solic ,O.tc_order_id              as N_Orden_Distribu ,O.created_dttm             as Fecha_Creacion_Orden ,MIN(POL.comm_dlvr_dttm)    as FechaCompromiso ,MIN(POL.COMM_SHIP_DTTM)    as FechaSalidaCD  ,TO_CHAR(MIN(POL.comm_dlvr_dttm), 'DD-MM-YYYY HH24:MI:SS') as FechaEntregaCliente ,POS.description            as Est_Orden ,POS2.description           as Estado_de_Linea ,POL.sku                    as SKU ,POL.allocated_qty          as Cant_Desc_SKU ,IC.prod_type               as Depart ,PO.entry_code              as Local_Venta ,MAX(AO.A_DCNAME)           AS BodegaDesp ,NVL(MAX(ASND.ref_field_7), 'Sin Informacion')      AS Est_1 ,NVL(MAX(ASND.ref_field_9), 'Sin Informacion')      AS Est_Entrega ,MIN(ASND.ref_field_10)     AS Fecha_Entr_Cliente  ,PO.customer_user_id        AS RutCliente ,PO.customer_firstname      AS NombreCliente ,PO.customer_lastname       AS ApellidoCliente ,POL.d_address_1            as Direccion_Cliente,POL.d_county               as Comuna ,POL.d_city                 as Ciudad ,POL.d_state_prov           as Region ,POLW.REF_FIELD_2           as Horario ,OT.order_type              as Tipo_Orden  ,CASE  WHEN ao.a_allocation_type = 1 THEN 'VEV CD' WHEN ao.a_allocation_type = 0 AND MAX(AO.A_DCNAME) NOT IN ('012', '200')THEN 'VEV PD' ELSE  'CD DESPACHA' END    as Tipo_Venta ,pol.comm_dlvr_dttm         as fecha_compromiso_2 ,o.O_FACILITY_ALIAS_ID ,CASE WHEN POL.d_state_prov in (13,50) THEN 'RM' ELSE 'REGIONES' END AS RegionEntrega ,CASE WHEN OT.order_type_id = 2 OR OT.order_type_id = 3 THEN 'POS' ELSE OT.order_type END AS TIPO_DE_ORDEN ,CASE  WHEN  MAX(ASND.ref_field_7) in ('Entregado','Entrega ','Entrega parcial', 'Recogido', 'Recogido parcial')  AND (TO_NUMBER(TO_CHAR((MIN(POL.comm_dlvr_dttm)),'YYYYMMDD')) - TO_NUMBER(to_char(to_timestamp((MIN(ASND.ref_field_10)),'YYYY-MM-DD HH24:MI:SS,FF3'),'YYYYMMDD')))  < -0.001 then 'ATRASADO'  WHEN MAX(ASND.ref_field_7) in ('Entregado','Entrega ','Entrega parcial', 'Recogido', 'Recogido parcial')    AND (TO_NUMBER(TO_CHAR((MIN(POL.comm_dlvr_dttm)),'YYYYMMDD')) - TO_NUMBER(to_char(to_timestamp((MIN(ASND.ref_field_10)),'YYYY-MM-DD HH24:MI:SS,FF3'),'YYYYMMDD')))  <= 0 then 'EN FECHA'  WHEN  MAX(ASND.ref_field_7) in ('Entregado','Entrega ','Entrega parcial', 'Recogido', 'Recogido parcial')   AND (TO_NUMBER(TO_CHAR((MIN(POL.comm_dlvr_dttm)),'YYYYMMDD')) - TO_NUMBER(to_char(to_timestamp((MIN(ASND.ref_field_10)),'YYYY-MM-DD HH24:MI:SS,FF3'),'YYYYMMDD')))  >0 then 'ADELANTADO' else NVL(MAX(ASND.ref_field_9), 'Sin Informacion') end as cumplimiento ,POL.D_POSTAL_CODE ,PO.EXT_PURCHASE_ORDERS_ID ,POL.TOTAL_MONETARY_VALUE ,POL.UNIT_MONETARY_VALUE           ,po.TC_PURCHASE_ORDERS_ID ,po.PURCHASE_ORDERS_TYPE  ,po.PARENT_PURCHASE_ORDERS_ID ,nvl(POL.D_EMAIL, o.bill_to_email) as D_EMAIL ,po.on_hold ,po.payment_status ,POL.order_fulfillment_option FROM CA14.purchase_orders po INNER JOIN CA14.PURCHASE_ORDERS_LINE_ITEM POL ON pol.purchase_orders_id = po.purchase_orders_id AND POL.Purchase_Orders_Line_Status <> 940 INNER JOIN CA14.purchase_orders_status pos   ON pos.purchase_orders_status = po.purchase_orders_status INNER JOIN CA14.a_orderinventoryallocation ao  ON ao.a_orderlineid = pol.purchase_orders_line_item_id AND ao.a_skuid =  pol.sku_id INNER JOIN CA14.order_type ot ON ot.order_type_id = po.order_category  INNER JOIN CA14.item_cbo ic ON ic.item_id = POL.SKU_ID LEFT JOIN CA14.order_line_item OLI ON OLI.PURCHASE_ORDER_LINE_NUMBER = POL.TC_PO_LINE_ID AND OLI.mo_line_item_id = POL.purchase_orders_line_item_id AND OLI.ITEM_ID = POL.SKU_ID  AND Oli.Is_Cancelled = 0 LEFT JOIN CA14.orders o ON o.Order_ID = OLI.Order_ID  AND o.purchase_order_id =  po.purchase_orders_id AND o.IS_CANCELLED = 0 LEFT JOIN CA14.ASN_DETAIL ASND ON asnd.ORDER_LINE_ITEM_ID = OLI.LINE_ITEM_ID AND asnd.order_id           = OLI.Order_Id AND asnd.tc_order_line_id   = OLI.Tc_Order_Line_Id AND ASND.ORDER_LINE_ITEM_ID = OLI.LINE_ITEM_ID LEFT JOIN CA14.PO_LINE_WMPROCESSINFO POLW    ON POLW.PURCHASE_ORDERS_LINE_ITEM_ID = pol.PURCHASE_ORDERS_LINE_ITEM_ID LEFT JOIN CA14.purchase_orders_status pos2 ON pos2.purchase_orders_status = pol.purchase_orders_line_status WHERE ot.order_type_id in (2, 3, 6, 12, 14, 22, 42, 82)  AND PO.is_purchase_orders_confirmed = '1'   AND nvl(o.D_FACILITY_ALIAS_ID, 0) = 0 AND pol.comm_dlvr_dttm >= to_date('15-10-2017 00:00:01','DD-MM-YYYY HH24:MI:SS') AND pol.comm_dlvr_dttm <= to_date('17-10-2017 23:59:59','DD-MM-YYYY HH24:MI:SS')   AND O.tc_order_id NOT IN ( SELECT O.tc_order_id FROM CA14.purchase_orders po INNER JOIN CA14.PURCHASE_ORDERS_LINE_ITEM POL    ON pol.purchase_orders_id = po.purchase_orders_id AND POL.Purchase_Orders_Line_Status <> 940 INNER JOIN CA14.a_orderinventoryallocation ao    ON ao.a_orderlineid = pol.purchase_orders_line_item_id AND AO.A_DCNAME not in ('012', '200') AND ao.a_skuid =  pol.sku_id INNER JOIN CA14.order_line_item OLI ON OLI.PURCHASE_ORDER_LINE_NUMBER = POL.TC_PO_LINE_ID AND OLI.mo_line_item_id = POL.purchase_orders_line_item_id AND OLI.ITEM_ID = POL.SKU_ID AND Oli.Is_Cancelled = 0 INNER JOIN CA14.orders o ON o.Order_ID = OLI.Order_ID AND o.purchase_order_id =  po.purchase_orders_id AND o.IS_CANCELLED = 0 AND o.o_facility_alias_id  IN ('012', '200', '400') INNER JOIN CA14.order_type ot ON ot.order_type_id = po.order_category WHERE ot.order_type_id in (2, 3, 6, 12, 14, 22, 42, 82)  AND PO.is_purchase_orders_confirmed = '1' AND pol.comm_dlvr_dttm >= to_date('15-10-2017 00:00:01','DD-MM-YYYY HH24:MI:SS') AND pol.comm_dlvr_dttm <= to_date('17-10-2017 23:59:59','DD-MM-YYYY HH24:MI:SS') )  GROUP BY po.tc_purchase_orders_id, po.created_dttm, o.tc_order_id, o.created_dttm, pol.must_dlvr_dttm ,pos.description, pol.sku, pol.allocated_qty, ic.prod_type, po.entry_code, pol.d_address_1 ,pol.d_county, pol.d_city, pol.d_state_prov, ot.order_type, POLW.REF_FIELD_2, po.customer_user_id ,po.customer_firstname, po.customer_lastname, pos2.description ,pol.tc_po_line_id, pol.comm_dlvr_dttm, o.O_FACILITY_ALIAS_ID,ao.a_allocation_type,POL.D_POSTAL_CODE,PO.EXT_PURCHASE_ORDERS_ID,POL.TOTAL_MONETARY_VALUE,POL.UNIT_MONETARY_VALUE     ,PO.TC_PURCHASE_ORDERS_ID,PO.PURCHASE_ORDERS_TYPE,PO.PARENT_PURCHASE_ORDERS_ID,POL.D_EMAIL,po.on_hold,po.payment_status,OT.order_type_id,o.bill_to_email,POL.order_fulfillment_option 

Archivos creados.

Fin Programa: 31/10/17 10:26:32

El programa finalizo.
